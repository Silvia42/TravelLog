

const listPlaces = 
[{"placeName": "Afghanistan", "description": "https://www.infoplease.com/world/countries/Afghanistan"}, {"placeName": "Albania", "description": "https://www.infoplease.com/world/countries/Albania"}, {"placeName": "Algeria", "description": "https://www.infoplease.com/world/countries/Algeria"}, {"placeName": "Andorra", "description": "https://www.infoplease.com/world/countries/Andorra"}, {"placeName": "Angola", "description": "https://www.infoplease.com/world/countries/Angola"}, {"placeName": "Antigua and Barbuda", "description": "https://www.infoplease.com/world/countries/Antigua and Barbuda"}, {"placeName": "Argentina", "description": "https://www.infoplease.com/world/countries/Argentina"}, {"placeName": "Armenia", "description": "https://www.infoplease.com/world/countries/Armenia"}, {"placeName": "Australia", "description": "https://www.infoplease.com/world/countries/Australia"}, {"placeName": "Austria", "description": "https://www.infoplease.com/world/countries/Austria"}, {"placeName": "Azerbaijan", "description": "https://www.infoplease.com/world/countries/Azerbaijan"}, {"placeName": "Bahamas", "description": "https://www.infoplease.com/world/countries/Bahamas"}, {"placeName": "Bahrain", "description": "https://www.infoplease.com/world/countries/Bahrain"}, {"placeName": "Bangladesh", "description": "https://www.infoplease.com/world/countries/Bangladesh"}, {"placeName": "Barbados", "description": "https://www.infoplease.com/world/countries/Barbados"}, {"placeName": "Belarus", "description": "https://www.infoplease.com/world/countries/Belarus"}, {"placeName": "Belgium", "description": "https://www.infoplease.com/world/countries/Belgium"}, {"placeName": "Belize", "description": "https://www.infoplease.com/world/countries/Belize"}, {"placeName": "Benin", "description": "https://www.infoplease.com/world/countries/Benin"}, {"placeName": "Bhutan", "description": "https://www.infoplease.com/world/countries/Bhutan"}, {"placeName": "Bolivia", "description": "https://www.infoplease.com/world/countries/Bolivia"}, {"placeName": "Bosnia and Herzegovina", "description": "https://www.infoplease.com/world/countries/Bosnia and Herzegovina"}, {"placeName": "Botswana", "description": "https://www.infoplease.com/world/countries/Botswana"}, {"placeName": "Brazil", "description": "https://www.infoplease.com/world/countries/Brazil"}, {"placeName": "Brunei", "description": "https://www.infoplease.com/world/countries/Brunei"}, {"placeName": "Bulgaria", "description": "https://www.infoplease.com/world/countries/Bulgaria"}, {"placeName": "Burkina Faso", "description": "https://www.infoplease.com/world/countries/Burkina Faso"}, {"placeName": "Burundi", "description": "https://www.infoplease.com/world/countries/Burundi"}, {"placeName": "C\u00f4te d'Ivoire", "description": "https://www.infoplease.com/world/countries/C\u00f4te d'Ivoire"}, {"placeName": "Cabo Verde", "description": "https://www.infoplease.com/world/countries/Cabo Verde"}, {"placeName": "Cambodia", "description": "https://www.infoplease.com/world/countries/Cambodia"}, {"placeName": "Cameroon", "description": "https://www.infoplease.com/world/countries/Cameroon"}, {"placeName": "Canada", "description": "https://www.infoplease.com/world/countries/Canada"}, {"placeName": "Central African Republic", "description": "https://www.infoplease.com/world/countries/Central African Republic"}, {"placeName": "Chad", "description": "https://www.infoplease.com/world/countries/Chad"}, {"placeName": "Chile", "description": "https://www.infoplease.com/world/countries/Chile"}, {"placeName": "China", "description": "https://www.infoplease.com/world/countries/China"}, {"placeName": "Colombia", "description": "https://www.infoplease.com/world/countries/Colombia"}, {"placeName": "Comoros", "description": "https://www.infoplease.com/world/countries/Comoros"}, {"placeName": "Congo (Congo-Brazzaville)", "description": "https://www.infoplease.com/world/countries/Congo (Congo-Brazzaville)"}, {"placeName": "Costa Rica", "description": "https://www.infoplease.com/world/countries/Costa Rica"}, {"placeName": "Croatia", "description": "https://www.infoplease.com/world/countries/Croatia"}, {"placeName": "Cuba", "description": "https://www.infoplease.com/world/countries/Cuba"}, {"placeName": "Cyprus", "description": "https://www.infoplease.com/world/countries/Cyprus"}, {"placeName": "Czechia (Czech Republic)", "description": "https://www.infoplease.com/world/countries/Czechia (Czech Republic)"}, {"placeName": "Democratic Republic of the Congo", "description": "https://www.infoplease.com/world/countries/Democratic Republic of the Congo"}, {"placeName": "Denmark", "description": "https://www.infoplease.com/world/countries/Denmark"}, {"placeName": "Djibouti", "description": "https://www.infoplease.com/world/countries/Djibouti"}, {"placeName": "Dominica", "description": "https://www.infoplease.com/world/countries/Dominica"}, {"placeName": "Dominican Republic", "description": "https://www.infoplease.com/world/countries/Dominican Republic"}, {"placeName": "Ecuador", "description": "https://www.infoplease.com/world/countries/Ecuador"}, {"placeName": "Egypt", "description": "https://www.infoplease.com/world/countries/Egypt"}, {"placeName": "El Salvador", "description": "https://www.infoplease.com/world/countries/El Salvador"}, {"placeName": "Equatorial Guinea", "description": "https://www.infoplease.com/world/countries/Equatorial Guinea"}, {"placeName": "Eritrea", "description": "https://www.infoplease.com/world/countries/Eritrea"}, {"placeName": "Estonia", "description": "https://www.infoplease.com/world/countries/Estonia"}, {"placeName": "Eswatini (fmr. \"Swaziland\")", "description": "https://www.infoplease.com/world/countries/Eswatini (fmr. \"Swaziland\")"}, {"placeName": "Ethiopia", "description": "https://www.infoplease.com/world/countries/Ethiopia"}, {"placeName": "Fiji", "description": "https://www.infoplease.com/world/countries/Fiji"}, {"placeName": "Finland", "description": "https://www.infoplease.com/world/countries/Finland"}, {"placeName": "France", "description": "https://www.infoplease.com/world/countries/France"}, {"placeName": "Gabon", "description": "https://www.infoplease.com/world/countries/Gabon"}, {"placeName": "Gambia", "description": "https://www.infoplease.com/world/countries/Gambia"}, {"placeName": "Georgia", "description": "https://www.infoplease.com/world/countries/Georgia"}, {"placeName": "Germany", "description": "https://www.infoplease.com/world/countries/Germany"}, {"placeName": "Ghana", "description": "https://www.infoplease.com/world/countries/Ghana"}, {"placeName": "Greece", "description": "https://www.infoplease.com/world/countries/Greece"}, {"placeName": "Grenada", "description": "https://www.infoplease.com/world/countries/Grenada"}, {"placeName": "Guatemala", "description": "https://www.infoplease.com/world/countries/Guatemala"}, {"placeName": "Guinea", "description": "https://www.infoplease.com/world/countries/Guinea"}, {"placeName": "Guinea-Bissau", "description": "https://www.infoplease.com/world/countries/Guinea-Bissau"}, {"placeName": "Guyana", "description": "https://www.infoplease.com/world/countries/Guyana"}, {"placeName": "Haiti", "description": "https://www.infoplease.com/world/countries/Haiti"}, {"placeName": "Holy See", "description": "https://www.infoplease.com/world/countries/Holy See"}, {"placeName": "Honduras", "description": "https://www.infoplease.com/world/countries/Honduras"}, {"placeName": "Hungary", "description": "https://www.infoplease.com/world/countries/Hungary"}, {"placeName": "Iceland", "description": "https://www.infoplease.com/world/countries/Iceland"}, {"placeName": "India", "description": "https://www.infoplease.com/world/countries/India"}, {"placeName": "Indonesia", "description": "https://www.infoplease.com/world/countries/Indonesia"}, {"placeName": "Iran", "description": "https://www.infoplease.com/world/countries/Iran"}, {"placeName": "Iraq", "description": "https://www.infoplease.com/world/countries/Iraq"}, {"placeName": "Ireland", "description": "https://www.infoplease.com/world/countries/Ireland"}, {"placeName": "Israel", "description": "https://www.infoplease.com/world/countries/Israel"}, {"placeName": "Italy", "description": "https://www.infoplease.com/world/countries/Italy"}, {"placeName": "Jamaica", "description": "https://www.infoplease.com/world/countries/Jamaica"}, {"placeName": "Japan", "description": "https://www.infoplease.com/world/countries/Japan"}, {"placeName": "Jordan", "description": "https://www.infoplease.com/world/countries/Jordan"}, {"placeName": "Kazakhstan", "description": "https://www.infoplease.com/world/countries/Kazakhstan"}, {"placeName": "Kenya", "description": "https://www.infoplease.com/world/countries/Kenya"}, {"placeName": "Kiribati", "description": "https://www.infoplease.com/world/countries/Kiribati"}, {"placeName": "Kuwait", "description": "https://www.infoplease.com/world/countries/Kuwait"}, {"placeName": "Kyrgyzstan", "description": "https://www.infoplease.com/world/countries/Kyrgyzstan"}, {"placeName": "Laos", "description": "https://www.infoplease.com/world/countries/Laos"}, {"placeName": "Latvia", "description": "https://www.infoplease.com/world/countries/Latvia"}, {"placeName": "Lebanon", "description": "https://www.infoplease.com/world/countries/Lebanon"}, {"placeName": "Lesotho", "description": "https://www.infoplease.com/world/countries/Lesotho"}, {"placeName": "Liberia", "description": "https://www.infoplease.com/world/countries/Liberia"}, {"placeName": "Libya", "description": "https://www.infoplease.com/world/countries/Libya"}, {"placeName": "Liechtenstein", "description": "https://www.infoplease.com/world/countries/Liechtenstein"}, {"placeName": "Lithuania", "description": "https://www.infoplease.com/world/countries/Lithuania"}, {"placeName": "Luxembourg", "description": "https://www.infoplease.com/world/countries/Luxembourg"}, {"placeName": "Madagascar", "description": "https://www.infoplease.com/world/countries/Madagascar"}, {"placeName": "Malawi", "description": "https://www.infoplease.com/world/countries/Malawi"}, {"placeName": "Malaysia", "description": "https://www.infoplease.com/world/countries/Malaysia"}, {"placeName": "Maldives", "description": "https://www.infoplease.com/world/countries/Maldives"}, {"placeName": "Mali", "description": "https://www.infoplease.com/world/countries/Mali"}, {"placeName": "Malta", "description": "https://www.infoplease.com/world/countries/Malta"}, {"placeName": "Marshall Islands", "description": "https://www.infoplease.com/world/countries/Marshall Islands"}, {"placeName": "Mauritania", "description": "https://www.infoplease.com/world/countries/Mauritania"}, {"placeName": "Mauritius", "description": "https://www.infoplease.com/world/countries/Mauritius"}, {"placeName": "Mexico", "description": "https://www.infoplease.com/world/countries/Mexico"}, {"placeName": "Micronesia", "description": "https://www.infoplease.com/world/countries/Micronesia"}, {"placeName": "Moldova", "description": "https://www.infoplease.com/world/countries/Moldova"}, {"placeName": "Monaco", "description": "https://www.infoplease.com/world/countries/Monaco"}, {"placeName": "Mongolia", "description": "https://www.infoplease.com/world/countries/Mongolia"}, {"placeName": "Montenegro", "description": "https://www.infoplease.com/world/countries/Montenegro"}, {"placeName": "Morocco", "description": "https://www.infoplease.com/world/countries/Morocco"}, {"placeName": "Mozambique", "description": "https://www.infoplease.com/world/countries/Mozambique"}, {"placeName": "Myanmar (formerly Burma)", "description": "https://www.infoplease.com/world/countries/Myanmar (formerly Burma)"}, {"placeName": "Namibia", "description": "https://www.infoplease.com/world/countries/Namibia"}, {"placeName": "Nauru", "description": "https://www.infoplease.com/world/countries/Nauru"}, {"placeName": "Nepal", "description": "https://www.infoplease.com/world/countries/Nepal"}, {"placeName": "Netherlands", "description": "https://www.infoplease.com/world/countries/Netherlands"}, {"placeName": "New Zealand", "description": "https://www.infoplease.com/world/countries/New Zealand"}, {"placeName": "Nicaragua", "description": "https://www.infoplease.com/world/countries/Nicaragua"}, {"placeName": "Niger", "description": "https://www.infoplease.com/world/countries/Niger"}, {"placeName": "Nigeria", "description": "https://www.infoplease.com/world/countries/Nigeria"}, {"placeName": "North Korea", "description": "https://www.infoplease.com/world/countries/North Korea"}, {"placeName": "North Macedonia", "description": "https://www.infoplease.com/world/countries/North Macedonia"}, {"placeName": "Norway", "description": "https://www.infoplease.com/world/countries/Norway"}, {"placeName": "Oman", "description": "https://www.infoplease.com/world/countries/Oman"}, {"placeName": "Pakistan", "description": "https://www.infoplease.com/world/countries/Pakistan"}, {"placeName": "Palau", "description": "https://www.infoplease.com/world/countries/Palau"}, {"placeName": "Palestine State", "description": "https://www.infoplease.com/world/countries/Palestine State"}, {"placeName": "Panama", "description": "https://www.infoplease.com/world/countries/Panama"}, {"placeName": "Papua New Guinea", "description": "https://www.infoplease.com/world/countries/Papua New Guinea"}, {"placeName": "Paraguay", "description": "https://www.infoplease.com/world/countries/Paraguay"}, {"placeName": "Peru", "description": "https://www.infoplease.com/world/countries/Peru"}, {"placeName": "Philippines", "description": "https://www.infoplease.com/world/countries/Philippines"}, {"placeName": "Poland", "description": "https://www.infoplease.com/world/countries/Poland"}, {"placeName": "Portugal", "description": "https://www.infoplease.com/world/countries/Portugal"}, {"placeName": "Qatar", "description": "https://www.infoplease.com/world/countries/Qatar"}, {"placeName": "Romania", "description": "https://www.infoplease.com/world/countries/Romania"}, {"placeName": "Russia", "description": "https://www.infoplease.com/world/countries/Russia"}, {"placeName": "Rwanda", "description": "https://www.infoplease.com/world/countries/Rwanda"}, {"placeName": "Saint Kitts and Nevis", "description": "https://www.infoplease.com/world/countries/Saint Kitts and Nevis"}, {"placeName": "Saint Lucia", "description": "https://www.infoplease.com/world/countries/Saint Lucia"}, {"placeName": "Saint Vincent and the Grenadines", "description": "https://www.infoplease.com/world/countries/Saint Vincent and the Grenadines"}, {"placeName": "Samoa", "description": "https://www.infoplease.com/world/countries/Samoa"}, {"placeName": "San Marino", "description": "https://www.infoplease.com/world/countries/San Marino"}, {"placeName": "Sao Tome and Principe", "description": "https://www.infoplease.com/world/countries/Sao Tome and Principe"}, {"placeName": "Saudi Arabia", "description": "https://www.infoplease.com/world/countries/Saudi Arabia"}, {"placeName": "Senegal", "description": "https://www.infoplease.com/world/countries/Senegal"}, {"placeName": "Serbia", "description": "https://www.infoplease.com/world/countries/Serbia"}, {"placeName": "Seychelles", "description": "https://www.infoplease.com/world/countries/Seychelles"}, {"placeName": "Sierra Leone", "description": "https://www.infoplease.com/world/countries/Sierra Leone"}, {"placeName": "Singapore", "description": "https://www.infoplease.com/world/countries/Singapore"}, {"placeName": "Slovakia", "description": "https://www.infoplease.com/world/countries/Slovakia"}, {"placeName": "Slovenia", "description": "https://www.infoplease.com/world/countries/Slovenia"}, {"placeName": "Solomon Islands", "description": "https://www.infoplease.com/world/countries/Solomon Islands"}, {"placeName": "Somalia", "description": "https://www.infoplease.com/world/countries/Somalia"}, {"placeName": "South Africa", "description": "https://www.infoplease.com/world/countries/South Africa"}, {"placeName": "South Korea", "description": "https://www.infoplease.com/world/countries/South Korea"}, {"placeName": "South Sudan", "description": "https://www.infoplease.com/world/countries/South Sudan"}, {"placeName": "Spain", "description": "https://www.infoplease.com/world/countries/Spain"}, {"placeName": "Sri Lanka", "description": "https://www.infoplease.com/world/countries/Sri Lanka"}, {"placeName": "Sudan", "description": "https://www.infoplease.com/world/countries/Sudan"}, {"placeName": "Suriname", "description": "https://www.infoplease.com/world/countries/Suriname"}, {"placeName": "Sweden", "description": "https://www.infoplease.com/world/countries/Sweden"}, {"placeName": "Switzerland", "description": "https://www.infoplease.com/world/countries/Switzerland"}, {"placeName": "Syria", "description": "https://www.infoplease.com/world/countries/Syria"}, {"placeName": "Tajikistan", "description": "https://www.infoplease.com/world/countries/Tajikistan"}, {"placeName": "Tanzania", "description": "https://www.infoplease.com/world/countries/Tanzania"}, {"placeName": "Thailand", "description": "https://www.infoplease.com/world/countries/Thailand"}, {"placeName": "Timor-Leste", "description": "https://www.infoplease.com/world/countries/Timor-Leste"}, {"placeName": "Togo", "description": "https://www.infoplease.com/world/countries/Togo"}, {"placeName": "Tonga", "description": "https://www.infoplease.com/world/countries/Tonga"}, {"placeName": "Trinidad and Tobago", "description": "https://www.infoplease.com/world/countries/Trinidad and Tobago"}, {"placeName": "Tunisia", "description": "https://www.infoplease.com/world/countries/Tunisia"}, {"placeName": "Turkey", "description": "https://www.infoplease.com/world/countries/Turkey"}, {"placeName": "Turkmenistan", "description": "https://www.infoplease.com/world/countries/Turkmenistan"}, {"placeName": "Tuvalu", "description": "https://www.infoplease.com/world/countries/Tuvalu"}, {"placeName": "Uganda", "description": "https://www.infoplease.com/world/countries/Uganda"}, {"placeName": "Ukraine", "description": "https://www.infoplease.com/world/countries/Ukraine"}, {"placeName": "United Arab Emirates", "description": "https://www.infoplease.com/world/countries/United Arab Emirates"}, {"placeName": "United Kingdom", "description": "https://www.infoplease.com/world/countries/United Kingdom"}, {"placeName": "United States of America", "description": "https://www.infoplease.com/world/countries/United States of America"}, {"placeName": "Uruguay", "description": "https://www.infoplease.com/world/countries/Uruguay"}, {"placeName": "Uzbekistan", "description": "https://www.infoplease.com/world/countries/Uzbekistan"}, {"placeName": "Vanuatu", "description": "https://www.infoplease.com/world/countries/Vanuatu"}, {"placeName": "Venezuela", "description": "https://www.infoplease.com/world/countries/Venezuela"}, {"placeName": "Vietnam", "description": "https://www.infoplease.com/world/countries/Vietnam"}, {"placeName": "Yemen", "description": "https://www.infoplease.com/world/countries/Yemen"}, {"placeName": "Zambia", "description": "https://www.infoplease.com/world/countries/Zambia"}, {"placeName": "Zimbabwe", "description": "https://www.infoplease.com/world/countries/Zimbabwe"}]

// npm install node-fetch --save
const fetch = require("node-fetch");

// console.log(listPlaces.length)

// TypeError: Only absolute URLs are supported
const savePlacesToServer = (plc) =>
    // fetch("/api/place/",
    fetch("http://localhost:8000/api/place/",
        {
            method: "POST"
            , headers: { "Content-Type": "application/json" }
            , body: JSON.stringify(plc)
        }
    )
        .then(res => res.json())
        .catch(console.log)

const deletePlacesFromDB = (id) =>
    // fetch("/api/place/",
    fetch("http://localhost:8000/api/place/"+id.toString()+'/',
    {
    method: "DELETE"
    }
    )
    // .catch(console.log)
    

// savePlacesToServer({"placeName": "Zimbabwe", "description": "https://www.infoplease.com/world/countries/Zimbabwe"})


// savePlacesToServer(listPlaces)
// Author: Noah
// listPlaces.reduce((q, place) => q.then(() => savePlacesToServer(place)), Promise.resolve(null))

// deleteAllPlacesFromServer(listPlaces)
const getPlaces=()=>
    fetch("http://localhost:8000/api/place/")
    .then(res => res.json()) //.catch(console.log)
    // .then(res => res.json()).then(x=>console.log(x.id))

const allPlaces=getPlaces()
      //.then(console.log)
      //.then((x)=>x.map(y=>console.log(y.id)))
      //.then((x)=>x.map(y=>deletePlacesFromDB(y.id))) //partially working
      .then(
        (z=>z.reduce((q, y) => 
            q.then(() =>
                deletePlacesFromDB(y.id)),Promise.resolve(null))))

// deletePlacesFromDB(330) // this works

// const allPlaces=getPlaces()
//       //.then(console.log)
//       .then((x)=>{
//         x.reduce((q, id) => q.then(() => deletePlacesFromDB(id)), Promise.resolve(null))
//       })


// listPlaces.reduce((q, allPlaces) => q.then(() => deletePlacesFromDB(place)), Promise.resolve(null))

//////////////////////////////////////////////////////////////
//////////////////////////// CLEAN CODE //////////////////////
//////////////////////////////////////////////////////////////
// SAVE all records from list listPlaces on DB on Server
listPlaces.reduce((q, place) => 
                   q.then(() => savePlacesToServer(place)), 
                                Promise.resolve(null))
//////////////////////////////////////////////////////////////
// DELETE all records from DB on Server
// const allPlaces=getPlaces()
//       .then(
//             (z=>z.reduce((q, y) => 
//                           q.then(() =>
//                               deletePlacesFromDB(y.id)),
//                               Promise.resolve(null)
//                         )
//             )
//             )
//////////////////////////////////////////////////////////////
